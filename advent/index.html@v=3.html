<!DOCTYPE html>
<html lang="hu" class="no-js">

<head>
<meta charset="utf-8">
<title>InfoC :: Adventi naptár</title>
<meta property="og:title" content="InfoC :: Adventi naptár">
<meta property="og:image" content="/modulz/logo.png">
<meta property="og:description" content="InfoC :: Adventi naptár">
<meta property="og:site_name" content="InfoC – Programozás alapjai I.">
<meta name="description" content="InfoC :: Adventi naptár">
<meta name="keywords" content="bme eet infoc programozás prog1 szoftlab1">
<meta name="robots" content="noarchive">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="../modulz/favicon.ico" id="faviconhref">
<link rel="apple-touch-icon" href="../modulz/logo_touch.png">
<link rel="image_src" href="../modulz/logo.png"> 
<script>var infoc = { onloads: [], onresize: [] };</script>
<link rel="stylesheet" href="../modulz/style/style-vik.css@v10.css">
<link rel="stylesheet" href="../modulz/style/localfonts.css@v10.css">
<script src="../modulz/siteui.js@v10" async></script>
</head>

<body class="doksibody">
<!--[if lt IE 9]>
<blockquote><p>A régi Internet Explorer böngésző, amit használsz, nem támogatott!
Az oldal használatához keress egy <a href="http://browsehappy.com/">jobb, újabb böngészőprogramot</a>!</p></blockquote>
<![endif]-->
<div id="bodycontent">

<nav role="navigation">
<div id="menubg">
<div id="menu" class="shaper dropdown">
<div class="infoc"><a href="../index.html">InfoC</a></div>
<ul>
<li class="al "><a href="index.html@v=3.html#" onclick="menu_click(this)">Infó</a>
<ul>
<li><a href="../index.html">Kezdőlap</a>
<li><a href="../nhf.html">Nagy házi feladat</a>
<li><a href="../elerhetoseg.html">Elérhetőség</a>
</ul>

<li class="al "><a href="index.html@v=3.html#" onclick="menu_click(this)">Tananyag</a>
<ul>
<li class="al "><a href="index.html@v=3.html#" onclick="menu_click(this)">Előadás</a>
<ul>
<li><a href="../ea01.html">1. hét: bevezetés</a>
<li><a href="../ea02.html">2. hét: algoritmusok</a>
<li><a href="../ea03.html">3. hét: tételek, tömbök</a>
<li><a href="../ea04.html">4. hét: függvények, számábrázolás</a>
<li><a href="../ea05.html">5. hét: operátorok, struktúrák</a>
<li><a href="../ea06.html">6. hét: pointerek, állapotgépek</a>
<li><a href="../ea07.html">7. hét: rendezések, rekurzió</a>
<li><a href="../ea08.html">8. hét: dinamikus memóriakezelés</a>
<li><a href="../ea09.html">9. hét: láncolt listák</a>
<li><a href="../ea11.html">11. hét: fájlkezelés, modulok</a>
<li><a href="../ea12.html">12. hét: bináris fák</a>
<li><a href="../ea13.html">13. hét: generikus algoritmusok</a>
<li><a href="../ea14.html">14. hét: nagy program tervezése</a>
</ul>

<li class="al "><a href="index.html@v=3.html#" onclick="menu_click(this)">Gyakorlat</a>
<ul>
<li><a href="../gy01.html">1. hét: tanult algoritmusok</a>
<li><a href="../gy02.html">2. hét: algoritmizálás</a>
<li><a href="../gy03.html">3. hét: egyszerű programok</a>
<li><a href="../gy04.html">4. hét: tételek és tömbök</a>
<li><a href="../gy05.html">5. hét: függvények</a>
<li><a href="../gy06.html">6. hét: származtatott típusok</a>
<li><a href="../gy07.html">7. hét: mutatók használata</a>
<li><a href="../gy08.html">8. hét: rekurzió, állapotgép</a>
<li><a href="../gy09.html">9. hét: dinamikus tömbök</a>
<li><a href="../gy11.html">11. hét: láncolt listák I.</a>
<li><a href="../gy12.html">12. hét: láncolt listák II.</a>
<li><a href="../gy13.html">13. hét: bináris fák</a>
<li><a href="../gy14.html">14. hét: generikus algoritmusok</a>
</ul>

<li class="al "><a href="index.html@v=3.html#" onclick="menu_click(this)">Labor</a>
<ul>
<li><a href="../lab01.html">1. hét: operációs rendszer</a>
<li><a href="../lab02.html">2. hét: fejlesztőkörnyezet használata</a>
<li><a href="../lab03.html">3. hét: egyszerű programok</a>
<li><a href="../lab04.html">4. hét: tömbök</a>
<li><a href="../lab06.html">6. hét: struktúrák és függvények</a>
<li><a href="../lab06sz.html">6. hét, szombat: gyakorlófeladatok</a>
<li><a href="../lab08.html">8. hét: mutatók, sztringek</a>
<li><a href="../lab09.html">9. hét: dinamikus tömbök</a>
<li><a href="../lab10.html">10. hét: rekurzió és állapotgépek</a>
<li><a href="../lab11.html">11. hét: láncolt listák</a>
<li><a href="../lab12.html">12. hét: duplán láncolt listák</a>
<li><a href="../lab13.html">13. hét: bináris fák</a>
<li><a href="../lab14.html">14. hét: labirintus játék</a>
</ul>

<li class="al "><a href="index.html@v=3.html#" onclick="menu_click(this)">Példatár</a>
<ul>
<li><a href="../f01.html">1. hét: egyszerű programok</a>
<li><a href="../f02.html">2. hét: vezérlési szerkezetek</a>
<li><a href="../f03.html">3. hét: logika, sorozatok, tömbök</a>
<li><a href="../f04.html">4. hét: számábrázolás, bitek, függvények</a>
<li><a href="../f05.html">5. hét: operátorok, struktúrák</a>
<li><a href="../f06.html">6. hét: pointerek, sztringek, állapotgépek</a>
<li><a href="../f07.html">7. hét: rendezések, rekurzió</a>
<li><a href="../f08.html">8. hét: dinamikus memóriakezelés</a>
<li><a href="../f09.html">9. hét: láncolt listák</a>
<li><a href="../f11.html">11. hét: parancssor, fájlkezelés, modulok</a>
<li><a href="../f12.html">12. hét: bináris fák, többszörös indirekció</a>
<li><a href="../f13.html">13. hét: generikus algoritmusok</a>
</ul>

</ul>

<li class="al "><a href="index.html@v=3.html#" onclick="menu_click(this)">Segédlet</a>
<ul>
<li><a href="../jegyzet.html">Jegyzet és puska</a>
<li><a href="../fejlesztokornyezet.html">Fejlesztőkörnyezetek</a>
<li><a href="../stilus.html">Kódolási stílus</a>
<li><a href="../tanacsok.html">Tanácsok a tanuláshoz</a>
<li><a href="../debugmalloc.html">Debugmalloc</a>
<li><a href="../mintanhf.html">NHF minta</a>
</ul>

<li class="al "><a href="index.html@v=3.html#" onclick="menu_click(this)">Extrák</a>
<ul>
<li class="al "><a href="index.html@v=3.html#" onclick="menu_click(this)">Szorgalmik, versenyek</a>
<ul>
<li><a href="../nhfszepsegverseny2014.html">NHF szépségverseny 2014</a>
<li><a href="../nhfszepsegverseny2013.html">NHF szépségverseny 2013</a>
<li><a href="../nhfszepsegverseny2012.html">NHF szépségverseny 2012</a>
<li><a href="../orak.html">SVG óra galéria</a>
<li><a href="../angrybirds.html">SVG Angry Birds</a>
</ul>

<li class="al "><a href="index.html@v=3.html#" onclick="menu_click(this)">Elmélet</a>
<ul>
<li><a href="../turing.html">Mit tud a számítógép?</a>
<li><a href="../bf.html">BF</a>
<li><a href="../bitturmix.html">Bitturmix</a>
<li><a href="../labirintus.html">Labirintusok</a>
<li><a href="../tripla.html">Tripla indirekció</a>
</ul>

<li class="al "><a href="index.html@v=3.html#" onclick="menu_click(this)">Gyakorlat</a>
<ul>
<li><a href="../karakterkodolas.html">Karakterkódolások</a>
<li><a href="../strlcpy.html">Kulturált sztringmásoló</a>
<li><a href="../internet.html">Internet</a>
</ul>

<li class="al "><a href="index.html@v=3.html#" onclick="menu_click(this)">Grafika</a>
<ul>
<li><a href="../sdl.html">SDL grafika</a>
<li><a href="../sdl_telepito.html">SDL telepítés</a>
<li><a href="../fa.html">Fák rajzolása</a>
<li><a href="../lathatatlan.html">Láthatatlan zongorista</a>
</ul>

<li class="al "><a href="index.html@v=3.html#" onclick="menu_click(this)">Nyelvészet</a>
<ul>
<li><a href="../mondatelemzo.html">Mondatelemző</a>
<li><a href="../kifejezesek.html">Kifejezések</a>
<li><a href="../derivalas.html">Deriválás</a>
<li><a href="../ast_epit.html">AST: szintaxisfák</a>
<li><a href="../ast_epit_copa.html">AST: értékadás I.</a>
<li><a href="../ast_epit_parameteres.html">AST: értékadás II.</a>
</ul>

<li><a href="../advent.html">Adventi naptár</a>
</ul>

</ul>
</div>
</div>
</nav>

<main role="main">
<div id="doksi" class="shaper">
<section id="0">
<div class="slide" id="slide_0">
<div class="float" style="margin-top: 0.25em; margin-bottom: 0;"><a href="../advent.html">&larr; vissza</a></div>
<h1 class="eloadascim">Adventi naptár</h1>
<h2>fflush(stdin)</h2>

<p>
Írjunk egy programot, amelyik kér egy egész számot; utána pedig beolvas
egy sornyi szöveget.

<pre class="brush: c "  >
#include &lt;stdio.h&gt;

int main(void) {
    int i;
    char s[200];
    
    printf(&quot;Szam: &quot;); scanf(&quot;%d&quot;, &amp;i);
    printf(&quot;Szoveg: &quot;); fgets(s, 200, stdin);
    
    printf(&quot;A szamod: %d, a szoveged: [%s]\n&quot;, i, s);
    
    return 0;
}</pre>

<p>
Érdemes kipróbálni: a program <em>nem</em> olvassa be a szöveget. Helyette
a <code>fgets()</code> híváson látszólag átugrik, de igazából üres sort rak <code>s</code>-be.

<pre class="screenshot">
Szam: 5
Szoveg: A szamod: 5, a szoveged: [
]
</pre>

<p>
1. feladvány: miért?
<br>
2. feladvány: csináljunk valamit, hogy ez ne így legyen.

<nav><div id="tartalom">
<h3>Tartalom</h3>
<ol>
<li><a href="index.html@v=3.html#1">Mi történik?</a>
<li><a href="index.html@v=3.html#2">Hogyan tovább?</a>
<li><a href="index.html@v=3.html#3">Ugyanez karakterre</a>
</ol>
</div>
</nav>
</div>
</section>
<section id="1">
<div class="slide" id="slide_1">
<div class="slideheader">
<h2><span class="oldalszam">1</span>Mi történik?</h2>
</div>

<p>
Tegyük fel, hogy beírjuk: 5 &lt;enter&gt; hello &lt;enter&gt;. Ekkor a program a szabványos
bemenetén a következő karaktereket kapja:

<table class="tomb">
    <tr><td>5<td>↵<td>h<td>e<td>l<td>l<td>o<td>↵
</table>

<p>Logikus is: a <code>scanf %d</code> beolvassa az <code>5</code>-ös számot, beírja
<code>i</code>-be. A következő karakternél megáll, mert az az enter. Nem számjegy, ezért nem tartozhat egy
egész számhoz. Így kerül az 5 a változóba, és tér vissza a <code>scanf()</code> függvény 1-gyel.
<em>Ez az enter ott fog maradni a bemeneten.</em> A következő <code>fgets()</code> hívás enterig
olvassa a sort. Mivel az első karakter, amit ez meglát, pont az enter, ezért kerül az a 
sztringbe. A bemeneten egyébként a hello megmarad, ezt mondjuk egy következő <code>fgets()</code>
hívás beolvasná. Vagy ha utána megint egy <code> scanf %d</code> jönne, az meg hibakóddal térne 
vissza.

<div class="sticky"><img src="../modulz/halalfej.png" style="display: block"></div>
<p>Erre szokták azt mondani, hogy <code>fflush(stdin)</code>-t kell írni. <strong>Nem, nem kell 
azt írni.</strong> A C szabvány egy olvasásra megnyitott fájlnál az <code>fflush()</code>-tól nem
vár el semmit; vagyis a szabvány szerint az <code>fflush(stdin)</code> utasítás <strong>nem 
csinál semmit.</strong> Windowson, az MSDN szerint az <code>fflush()</code> input streamre 
„kiüríti a bemeneti puffert”, ami elég érdekesen hangzik, ugyanis nem egyértelmű, honnan kellene 
tudni, hogy meddig tart a bemeneti puffer. Ez a hülyeség amúgy annyira elterjedt, hogy könyvekben
is megjelent; és annyira, hogy más operációs rendszereken és függvénykönyvtárakon, pl. az újabb 
Linuxokon is elkezdték leutánozni az <code>fflush()</code> ilyen jellegű funkcionalitását &ndash;
tisztán kompatibilitási okokból, hogy a rosszul megírt programok működjenek. Azért csak 
jegyezzük meg, még akkor is, ha a fenti hülyeség sok helyen nyomtatásban is megjelent már:
<strong>az <code>fflush(stdin)</code> a szabvány szerint nem csinál semmit</strong>.</p>

<p>
Hogy lehet akkor javítani a programot? Legegyszerűbben úgy, hogy a <code>scanf %d</code> hívás után beteszünk
egy üres <code>getchar()</code>-t. Ott kell lennie egy enternek, azt az entert beolvassuk, eldobjuk.
A <code>fgets()</code> pedig majd már a <code>h</code> betűt látja elsőnek. Ezt a <code>getchar()</code>
hívást én közvetlenül a <code>scanf %d</code> után tenném. Akkor az a <code>scanf()</code>+<code>getchar()</code>
kombó beolvas egy számot, és nem hagy maga után semmit a bemeneten. Nem a következő beolvasás
leprogramozásánál kell emlékeznünk, hogy az előzőnél még maradt valamit a bemeneten. 
A javított rész:

<pre class="brush: c "  >
printf(&quot;Szam: &quot;); scanf(&quot;%d&quot;, &amp;i); getchar();
printf(&quot;Szoveg: &quot;); fgets(s, 200, stdin);</pre>

<pre class="screenshot">
Szam: 5
Szoveg: hello
A szamod: 5, a szoveged: [hello]
</pre>



</div>
</section>
<section id="2">
<div class="slide" id="slide_2">
<div class="slideheader">
<h2><span class="oldalszam">2</span>Hogyan tovább?</h2>
</div>

<p>
Most már akkor fejezzük be, amit elkezdtünk. Mi történik akkor, ha a felhasználó azt írja be, hogy
5 <kbd>szóköz</kbd> <kbd>enter</kbd> hello <kbd>enter</kbd>? A bemeneten ez lesz:

<table class="tomb">
    <tr><td>5<td>␣<td>↵<td>h<td>e<td>l<td>l<td>o<td>↵
</table>

<p>
Vagyis a <code>getchar()</code> hívásunk a szóközt fogja beolvasni, és az előző probléma újból
előáll.

<p>
Pontosan mit is kellene csinálnunk? A bemeneten van egy szám, utána lehetnek egyéb dolgok, amik minket
nem érdekelnek, az enterig; végül pedig egy enter (ami úgyszint nem érdekel bennünket). Nagyon
egyszerű, olvassuk be ezeket is, és dobjuk el.
Egyik megoldás lehet erre, hogy egészen addig olvasunk, amíg entert nem kapunk. Enternek biztosan
lennie kell előbb-utóbb.

<pre class="brush: c "  >
while (getchar()!='\n')
    ; /* üres */</pre>

<p>
A <code>scanf()</code>-et is használhatjuk erre. A <code>scanf %[]</code> hasonló a <code>%s</code>-hez;
egy szót olvas be egy sztringbe, csak itt a szögletes zárójelek között megadhatjuk azokat a karaktereket,
amelyek a szóban szerepelhetnek. Meg lehet adni tartományt is, pl. <code>sscanf("hello123", "%[a-z]", s)</code>
az <code>s</code> sztringbe „hello”-t ír. Meg lehet adni azt is, hogy egy adott karakter <em>ne</em> szerepeljen
a beolvasott szóban (vagyis annál megálljon a feldolgozás). Ezt a <code>^</code> kalap karakterrel tehetjük
meg. Emiatt a következő <code>scanf()</code> hívás egy egész sort beolvas a sztringbe (az entert
a bemeneten hagyja):

<pre class="brush: c "  >
char s[200];
scanf(&quot;%[^\n]&quot;, s);</pre>

<p>
Most, amit beolvastunk, azt el szeretnénk dobni. Utána az entert is be szeretnénk olvasni,
és azt is el szeretnénk dobni, ezért a bűvös formátumsztring a szám beolvasása után:

<pre class="brush: cbub "  >
int i;
scanf(&quot;%d&quot;, &amp;i);
scanf(&quot;%*[^\n]%*c&quot;); // nem is kap változót</pre>

<p>
Ez jó kell legyen, hiszen azért áll meg a <code>%[]</code>, mert entert talált, a következő, a <code>%c</code>
által beolvasott karakter az maga az enter lesz.

</div>
</section>
<section id="3">
<div class="slide" id="slide_3">
<div class="slideheader">
<h2><span class="oldalszam">3</span>Ugyanez karakterre</h2>
</div>
<p>
A <code>scanf %c</code>-nek van egy érdekes tulajdonsága. Az összes többi konverzió (pl. <code>%d</code>,
<code>%s</code> stb.) a beolvasott whitespace karaktereket eldobja, csak amikor nem whitespace
karaktert talál, akkor kezdi meg a konverziót.
Emiatt mindegy, ha egy számra várunk, hogy a felhasználó <code>"5"</code>-öt, vagy <code>"␣␣5"</code>-öt
ír be. A <code>scanf %c</code> viszont nem teszi ezt. Direkt, hogy egy whitespace karaktert is be lehessen vele
olvasni.

<p>
Írjunk egy programot, amelyik megkérdezi, hogy „igen(i) vagy nem(n)”, és utána kiírja, melyiket választottuk!
Ha a <code>scanf %c</code>-nek azt írjuk, hogy <code>"␣␣␣i"</code>, akkor a szóközt fogja a <code>c</code>-be
tenni, és nem működik rendesen. A <code>scanf()</code>-et a formátumsztringjében egy szóköz karakterrel
kérhetjük arra, hogy a szokásos whitespace karakterek eldobását elvégezze. Szóval a <code>scanf()</code> hívás,
amelyik beolvas egy karaktert, de nem zavarja, ha szóköz van előtte; illetve a többi karaktert eldobja, és
az entert sem hagyja ott a bemeneten:

<pre class="brush: cbub "  >
#include &lt;stdio.h&gt;

int main(void) {
    char c;
    
    printf(&quot;igen(i) vagy nem(n)? &quot;);
    scanf(&quot; %c%*[^\n]%*c&quot;, &amp;c); // omg
    switch (c) {
        case 'i': printf(&quot;igen\n&quot;); break;
        case 'n': printf(&quot;nem\n&quot;); break;
        default:  printf(&quot;???\n&quot;); break;
    }
    
    return 0;
}</pre>

<p>
Nem szokás amúgy ilyeneket írni… De láthatóan elég sok mindent össze lehet rakni a <code>scanf()</code>-fel.
</div>
</section>
</div>
</main>

<nav role="navigation">
<a href="index.html@v=3.html#menu" id="scrolltotop"></a>
</nav>

<footer role="contentinfo">
<div id="footer" class="shaper">
<a href="../index.html"><img src="../modulz/logo.png" id="footerlogo" alt="Logo"></a>
<div>InfoC – Programozás alapjai I.</div>
<div class="csakkepernyon"><a href="../index.html">főoldal</a> · <a href="../elerhetoseg.html">elérhetőség</a> · <a href="https://www.facebook.com/infoceetbmehu">facebook</a></div>
<div class="csaknyomtatasban">Kérjük, az oldalak kinyomtatása előtt gondolj a környezetre.</div>
BME EET, 2009-2014.</div>
</footer>

</div>
</body>

</html>
