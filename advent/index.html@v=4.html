<!DOCTYPE html>
<html lang="hu" class="no-js">

<head>
<meta charset="utf-8">
<title>InfoC :: Adventi naptár</title>
<meta property="og:title" content="InfoC :: Adventi naptár">
<meta property="og:image" content="/modulz/logo.png">
<meta property="og:description" content="InfoC :: Adventi naptár">
<meta property="og:site_name" content="InfoC – Programozás alapjai I.">
<meta name="description" content="InfoC :: Adventi naptár">
<meta name="keywords" content="bme eet infoc programozás prog1 szoftlab1">
<meta name="robots" content="noarchive">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="../modulz/favicon.ico" id="faviconhref">
<link rel="apple-touch-icon" href="../modulz/logo_touch.png">
<link rel="image_src" href="../modulz/logo.png"> 
<script>var infoc = { onloads: [], onresize: [] };</script>
<link rel="stylesheet" href="../modulz/style/style-vik.css@v10.css">
<link rel="stylesheet" href="../modulz/style/localfonts.css@v10.css">
<script src="../modulz/siteui.js@v10" async></script>
</head>

<body class="doksibody">
<!--[if lt IE 9]>
<blockquote><p>A régi Internet Explorer böngésző, amit használsz, nem támogatott!
Az oldal használatához keress egy <a href="http://browsehappy.com/">jobb, újabb böngészőprogramot</a>!</p></blockquote>
<![endif]-->
<div id="bodycontent">

<nav role="navigation">
<div id="menubg">
<div id="menu" class="shaper dropdown">
<div class="infoc"><a href="../index.html">InfoC</a></div>
<ul>
<li class="al "><a href="index.html@v=4.html#" onclick="menu_click(this)">Infó</a>
<ul>
<li><a href="../index.html">Kezdőlap</a>
<li><a href="../nhf.html">Nagy házi feladat</a>
<li><a href="../elerhetoseg.html">Elérhetőség</a>
</ul>

<li class="al "><a href="index.html@v=4.html#" onclick="menu_click(this)">Tananyag</a>
<ul>
<li class="al "><a href="index.html@v=4.html#" onclick="menu_click(this)">Előadás</a>
<ul>
<li><a href="../ea01.html">1. hét: bevezetés</a>
<li><a href="../ea02.html">2. hét: algoritmusok</a>
<li><a href="../ea03.html">3. hét: tételek, tömbök</a>
<li><a href="../ea04.html">4. hét: függvények, számábrázolás</a>
<li><a href="../ea05.html">5. hét: operátorok, struktúrák</a>
<li><a href="../ea06.html">6. hét: pointerek, állapotgépek</a>
<li><a href="../ea07.html">7. hét: rendezések, rekurzió</a>
<li><a href="../ea08.html">8. hét: dinamikus memóriakezelés</a>
<li><a href="../ea09.html">9. hét: láncolt listák</a>
<li><a href="../ea11.html">11. hét: fájlkezelés, modulok</a>
<li><a href="../ea12.html">12. hét: bináris fák</a>
<li><a href="../ea13.html">13. hét: generikus algoritmusok</a>
<li><a href="../ea14.html">14. hét: nagy program tervezése</a>
</ul>

<li class="al "><a href="index.html@v=4.html#" onclick="menu_click(this)">Gyakorlat</a>
<ul>
<li><a href="../gy01.html">1. hét: tanult algoritmusok</a>
<li><a href="../gy02.html">2. hét: algoritmizálás</a>
<li><a href="../gy03.html">3. hét: egyszerű programok</a>
<li><a href="../gy04.html">4. hét: tételek és tömbök</a>
<li><a href="../gy05.html">5. hét: függvények</a>
<li><a href="../gy06.html">6. hét: származtatott típusok</a>
<li><a href="../gy07.html">7. hét: mutatók használata</a>
<li><a href="../gy08.html">8. hét: rekurzió, állapotgép</a>
<li><a href="../gy09.html">9. hét: dinamikus tömbök</a>
<li><a href="../gy11.html">11. hét: láncolt listák I.</a>
<li><a href="../gy12.html">12. hét: láncolt listák II.</a>
<li><a href="../gy13.html">13. hét: bináris fák</a>
<li><a href="../gy14.html">14. hét: generikus algoritmusok</a>
</ul>

<li class="al "><a href="index.html@v=4.html#" onclick="menu_click(this)">Labor</a>
<ul>
<li><a href="../lab01.html">1. hét: operációs rendszer</a>
<li><a href="../lab02.html">2. hét: fejlesztőkörnyezet használata</a>
<li><a href="../lab03.html">3. hét: egyszerű programok</a>
<li><a href="../lab04.html">4. hét: tömbök</a>
<li><a href="../lab06.html">6. hét: struktúrák és függvények</a>
<li><a href="../lab06sz.html">6. hét, szombat: gyakorlófeladatok</a>
<li><a href="../lab08.html">8. hét: mutatók, sztringek</a>
<li><a href="../lab09.html">9. hét: dinamikus tömbök</a>
<li><a href="../lab10.html">10. hét: rekurzió és állapotgépek</a>
<li><a href="../lab11.html">11. hét: láncolt listák</a>
<li><a href="../lab12.html">12. hét: duplán láncolt listák</a>
<li><a href="../lab13.html">13. hét: bináris fák</a>
<li><a href="../lab14.html">14. hét: labirintus játék</a>
</ul>

<li class="al "><a href="index.html@v=4.html#" onclick="menu_click(this)">Példatár</a>
<ul>
<li><a href="../f01.html">1. hét: egyszerű programok</a>
<li><a href="../f02.html">2. hét: vezérlési szerkezetek</a>
<li><a href="../f03.html">3. hét: logika, sorozatok, tömbök</a>
<li><a href="../f04.html">4. hét: számábrázolás, bitek, függvények</a>
<li><a href="../f05.html">5. hét: operátorok, struktúrák</a>
<li><a href="../f06.html">6. hét: pointerek, sztringek, állapotgépek</a>
<li><a href="../f07.html">7. hét: rendezések, rekurzió</a>
<li><a href="../f08.html">8. hét: dinamikus memóriakezelés</a>
<li><a href="../f09.html">9. hét: láncolt listák</a>
<li><a href="../f11.html">11. hét: parancssor, fájlkezelés, modulok</a>
<li><a href="../f12.html">12. hét: bináris fák, többszörös indirekció</a>
<li><a href="../f13.html">13. hét: generikus algoritmusok</a>
</ul>

</ul>

<li class="al "><a href="index.html@v=4.html#" onclick="menu_click(this)">Segédlet</a>
<ul>
<li><a href="../jegyzet.html">Jegyzet és puska</a>
<li><a href="../fejlesztokornyezet.html">Fejlesztőkörnyezetek</a>
<li><a href="../stilus.html">Kódolási stílus</a>
<li><a href="../tanacsok.html">Tanácsok a tanuláshoz</a>
<li><a href="../debugmalloc.html">Debugmalloc</a>
<li><a href="../mintanhf.html">NHF minta</a>
</ul>

<li class="al "><a href="index.html@v=4.html#" onclick="menu_click(this)">Extrák</a>
<ul>
<li class="al "><a href="index.html@v=4.html#" onclick="menu_click(this)">Szorgalmik, versenyek</a>
<ul>
<li><a href="../nhfszepsegverseny2014.html">NHF szépségverseny 2014</a>
<li><a href="../nhfszepsegverseny2013.html">NHF szépségverseny 2013</a>
<li><a href="../nhfszepsegverseny2012.html">NHF szépségverseny 2012</a>
<li><a href="../orak.html">SVG óra galéria</a>
<li><a href="../angrybirds.html">SVG Angry Birds</a>
</ul>

<li class="al "><a href="index.html@v=4.html#" onclick="menu_click(this)">Elmélet</a>
<ul>
<li><a href="../turing.html">Mit tud a számítógép?</a>
<li><a href="../bf.html">BF</a>
<li><a href="../bitturmix.html">Bitturmix</a>
<li><a href="../labirintus.html">Labirintusok</a>
<li><a href="../tripla.html">Tripla indirekció</a>
</ul>

<li class="al "><a href="index.html@v=4.html#" onclick="menu_click(this)">Gyakorlat</a>
<ul>
<li><a href="../karakterkodolas.html">Karakterkódolások</a>
<li><a href="../strlcpy.html">Kulturált sztringmásoló</a>
<li><a href="../internet.html">Internet</a>
</ul>

<li class="al "><a href="index.html@v=4.html#" onclick="menu_click(this)">Grafika</a>
<ul>
<li><a href="../sdl.html">SDL grafika</a>
<li><a href="../sdl_telepito.html">SDL telepítés</a>
<li><a href="../fa.html">Fák rajzolása</a>
<li><a href="../lathatatlan.html">Láthatatlan zongorista</a>
</ul>

<li class="al "><a href="index.html@v=4.html#" onclick="menu_click(this)">Nyelvészet</a>
<ul>
<li><a href="../mondatelemzo.html">Mondatelemző</a>
<li><a href="../kifejezesek.html">Kifejezések</a>
<li><a href="../derivalas.html">Deriválás</a>
<li><a href="../ast_epit.html">AST: szintaxisfák</a>
<li><a href="../ast_epit_copa.html">AST: értékadás I.</a>
<li><a href="../ast_epit_parameteres.html">AST: értékadás II.</a>
</ul>

<li><a href="../advent.html">Adventi naptár</a>
</ul>

</ul>
</div>
</div>
</nav>

<main role="main">
<div id="doksi" class="shaper">
<section id="0">
<div class="slide" id="slide_0">
<div class="float" style="margin-top: 0.25em; margin-bottom: 0;"><a href="../advent.html">&larr; vissza</a></div>
<h1 class="eloadascim">Adventi naptár</h1>
<h2><code>scanf %n</code></h2>

<p>
A <code>scanf()</code>-nek van egy érdekes konverziója,
amelyik igazából nem is konverzió. A <code>%n</code>
hatására, amelynek megfelelő helyen egy <code>int*</code>-ot
kell elhelyeznünk a paraméterlistán, a <code>scanf()</code>
a megadott változóba írja, hogy addig a pontig hány
karaktert dolgozott fel. Hatására konverzió nem történik,
és karakter sem olvasódik be, csak a karakterek számát írja
a változóba.

<p>
Ez hasznos lehet, ha egy sztringet nem tudunk egyszerre,
egészében feldolgozni. Tegyük fel azt, hogy van egy fájlunk,
amelyben a sorok formátuma lent látható.
Tudjuk azt, hogy az esemény leírása egy vagy több szó is lehet.
Ha több szóból áll az esemény, akkor idézőjelek <code>""</code>
között van megadva, ha csak egy szó, akkor pedig azok nélkül.

<pre class="papir mono">
év-hónap-nap óra:perc eseményleírás hibakód
2010-11-30 12:45 egyszavas 404
2010-12-01 16:27 "tobb szobol allo" 201
</pre>

<p>
A <code>scanf()</code>-fel tudunk szóközig olvasni (<code>%s</code>),
és tudunk idézőjelig is (<code>%[^"]</code>). Csak azt nem tudjuk
eldönteni előre, hogy melyik fog kelleni, és ezért nem lehet
olyan formátumsztringet írni, amelyik az egész sort egyszerre
képes lenne szétbontani.

<p>
Ilyenkor jön jól a <code>%n</code>. Beolvassuk a sztringet addig a
pontig, amikor döntenünk kell, hogy idézőjelet látunk vagy nem. Egy
<code>%n</code>-t rakva a formátumsztring végére a <code>scanf()</code>
megmondja, a beolvasás hányadik karakternél állt meg; így a döntést
meghozva (idézőjeles sztring vagy nem) onnan tudjuk folytatni.

<pre class="brush: c "  >
#include &lt;stdio.h&gt;

int main(void) {
    /* ezeket dolgozzuk fel */
    char *sztringek[]= {
        &quot;2010-11-30 12:45 egyszavas 404&quot;,
        &quot;2010-12-01 16:27 \&quot;tobb szobol allo\&quot; 201&quot;
    };

    /* ebbe */
    int ev, honap, nap, ora, perc;
    char szoveg[100];
    int szam;
    
    int i;    /* ennek magyarazatat lentebb */
    int j;    /* csak sima ciklusvaltozo */

    for (j=0; j&lt;2; j++) {
        char *feldolgoz=sztringek[j];
    
        /* beolvassuk az elejet, meg meg egy spacet.
         * az eredmenyek mennek a szamokba;
         * es a beolvasott karakterek szama i-be. */
        sscanf(feldolgoz, &quot;%d-%d-%d %d:%d %n&quot;,
            &amp;ev, &amp;honap, &amp;nap, &amp;ora, &amp;perc, &amp;i);

        /* es most a kovetkezo karakter (feldolgoz[i])
         * a kovetkezo sztring elso karaktere, ha nem idezojeles.
         * ha idezojeles, akkor pedig maga az idezojel.
         * ennek megfeleloen beolvassuk, vagy a kovetkezo
         * spaceig, vagy a &quot;bezaro&quot; idezojelig.
         * mindket esetben beolvassuk az utana kovetkezo
         * spacet is, es utana megint megjegyezzuk az innen
         * beolvasott karakterek szamat. */
        feldolgoz+=i;
        if (*feldolgoz=='&quot;')
            sscanf(feldolgoz, &quot;\&quot;%[^\&quot;]\&quot; %n&quot;, szoveg, &amp;i);
        else
            sscanf(feldolgoz, &quot;%s %n&quot;, szoveg, &amp;i);
        
        /* es most jon a vege. */
        /* megin kihagyunk annyi karaktert, amennyit mar
         * beolvastunk az elobb. */
        feldolgoz+=i;
        sscanf(feldolgoz, &quot;%d&quot;, &amp;szam);
        
        printf(&quot;%d-%d-%d %d:%d [%s] %d\n&quot;,
            ev, honap, nap, ora, perc, szoveg, szam);
    }
    
    return 0;
    
}</pre>

<p>A <code>printf()</code> tudja ugyanezt, csak nem a beolvasott, hanem a <code>%n</code>-ig 
bezárólag kiírt karakterek számát adja meg egy cím szerint átadott <code>int</code> változóban 
Emiatt egyébként különösen fontos, hogy egy felhasználótól származó sztringet
<code>printf("%s", s);</code> utasítással írjunk ki, ne a <code>printf(s);</code> sorral. A sztring ugyanis 
tartalmazhat <code>%</code> karaktert, amelyet a <code>printf()</code> értelmezni fog; ha
<code>%n</code>-t tartalmaz, akkor pedig még írni is fog majd valahova a memóriába. Így a lenti, bal 
oldali kód hibás. Ha a felhasználó pl. azt írja be, hogy „%d”, akkor a <code>printf()</code> a 
paraméterei között keres egy számot is. A helyes változat jobb oldalt látható.

<div class="columns">
<div>
<pre class="brush: c athuzott"  >
char s[100];
fgets(s, 100, stdin);
printf(s);</pre>
</div>
<div>
<pre class="brush: c "  >
char s[100];
fgets(s, 100, stdin);
printf(&quot;%s&quot;, s);</pre>
</div>
</div>

<nav><div id="tartalom"></div></nav>
</div>
</section>
</div>
</main>

<nav role="navigation">
<a href="index.html@v=4.html#menu" id="scrolltotop"></a>
</nav>

<footer role="contentinfo">
<div id="footer" class="shaper">
<a href="../index.html"><img src="../modulz/logo.png" id="footerlogo" alt="Logo"></a>
<div>InfoC – Programozás alapjai I.</div>
<div class="csakkepernyon"><a href="../index.html">főoldal</a> · <a href="../elerhetoseg.html">elérhetőség</a> · <a href="https://www.facebook.com/infoceetbmehu">facebook</a></div>
<div class="csaknyomtatasban">Kérjük, az oldalak kinyomtatása előtt gondolj a környezetre.</div>
BME EET, 2009-2014.</div>
</footer>

</div>
</body>

</html>
